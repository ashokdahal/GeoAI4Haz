Forked and Modified from Matteo Ravasi (KAUST).
